# Single Particle tracking on AFM kymograph
Python code to track a central plug in the fast-scan axis of the kymograph generated by high speed atomic force microscopy (HS-AFM).
It should be noted that the kymograph needs to be prepared as a single image beforehand, and that the y- and x-axis of the kymograph are scan direction and time (left to right), respectively. 
This tracking algorithm was used to analyze the plug positions within nuclear pore complexes (NPCs) or Nsp1FG-functionalized DNA origami scaffolds measured by HS-AFM line scanning.

The script has been tested on Python v3.9, Windows 11 v23H2 OS Build 22631.3007.

To run the script:

1. make sure that all libraries written in "requirements.txt" are installed into your working environment
2. directly download the "cp_tracking_kymo.py" and "cp_tracking.yaml" files. This should be done immediately.
3. enter the parameters required in the "cp_tracking.yaml" file. Instructions can be found after "#" in the yaml file.
4. make sure that the script, YAML and data files are located in the same directory.
5. type the following command in Terminal: "cp_tracking_kymo.py -p cp_tracking.yaml"
6. press "Enter" to run

In the test folder, there is an example kymograph data. You can download the data and test the code on it.
The run time should be around 5 seconds on the example data.
   
The outputs will be two files:

1. a CSV file contaning pixel positions of the kymograph in the y-axis (the top position is 0), nanometer distance from the center of the kymograph in the y-axis, and radius from the center of the kymograph in the y-axis.
2. a PNG file of the kymograph overlaid trajectory 
